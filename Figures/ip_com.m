cla;
clear FS;

hold on
FS(1).a = 0.000000;
FS(1).p = [0.000000;0.050000];
FS(1).d = [0.090000;0.075000;0.030000;-0.025000];
FS(1).D = [1.000000 0.000000;-0.000000 1.000000;-1.000000 -0.000000;0.000000 -1.000000];
FS(1).v = [0.090000 0.025000; 0.090000 0.075000; -0.030000 0.075000; -0.030000 0.025000; 0.090000 0.025000];
FS(1).type = 2;
plot (FS(1).v(:,1), FS(1).v(:,2), 'r');

FS(3).a = -0.019169;
FS(3).p = [-0.001123;-0.047206];
FS(3).d = [0.089782;-0.022219;0.030218;0.072219];
FS(3).D = [0.999816 -0.019167;0.019167 0.999816;-0.999816 0.019167;-0.019167 -0.999816];
FS(3).v = [0.088381 -0.073926; 0.089340 -0.023935; -0.030638 -0.021635; -0.031597 -0.071626; 0.088381 -0.073926];
FS(3).type = 2;
plot (FS(3).v(:,1), FS(3).v(:,2), 'r');

FS(7).a = -0.016127;
FS(7).p = [0.039879;0.049898];
FS(7).d = [0.129070;0.075534;-0.009070;-0.025534];
FS(7).D = [0.999870 -0.016126;0.016126 0.999870;-0.999870 0.016126;-0.016126 -0.999870];
FS(7).v = [0.129465 0.023449; 0.130271 0.073443; 0.010286 0.075378; 0.009480 0.025385; 0.129465 0.023449];
FS(7).type = 2;
plot (FS(7).v(:,1), FS(7).v(:,2), 'k');

FS(11).a = -0.019321;
FS(11).p = [0.081320;-0.052056];
FS(11).d = [0.172311;-0.025475;-0.052311;0.075475];
FS(11).D = [0.999813 -0.019319;0.019319 0.999813;-0.999813 0.019319;-0.019319 -0.999813];
FS(11).v = [0.170821 -0.078790; 0.171787 -0.028800; 0.051809 -0.026481; 0.050843 -0.076472; 0.170821 -0.078790];
FS(11).type = 2;
plot (FS(11).v(:,1), FS(11).v(:,2), 'k');

FS(15).a = 0.010159;
FS(15).p = [0.121080;0.051691];
FS(15).d = [0.211599;0.075458;-0.091599;-0.025458];
FS(15).D = [0.999948 0.010159;-0.010159 0.999948;-0.999948 -0.010159;0.010159 -0.999948];
FS(15).v = [0.211329 0.027606; 0.210821 0.077604; 0.090827 0.076385; 0.091335 0.026387; 0.211329 0.027606];
FS(15).type = 2;
plot (FS(15).v(:,1), FS(15).v(:,2), 'r');

FS(19).a = -0.013676;
FS(19).p = [0.162149;-0.051373];
FS(19).d = [0.252837;-0.024151;-0.132837;0.074151];
FS(19).D = [0.999906 -0.013676;0.013676 0.999906;-0.999906 0.013676;-0.013676 -0.999906];
FS(19).v = [0.251799 -0.077602; 0.252483 -0.027607; 0.132494 -0.025966; 0.131810 -0.075961; 0.251799 -0.077602];
FS(19).type = 2;
plot (FS(19).v(:,1), FS(19).v(:,2), 'r');

FS(23).a = 0.002873;
FS(23).p = [0.200407;0.050044];
FS(23).d = [0.290550;0.074468;-0.170550;-0.024468];
FS(23).D = [0.999996 0.002873;-0.002873 0.999996;-0.999996 -0.002873;0.002873 -0.999996];
FS(23).v = [0.290479 0.025303; 0.290335 0.075302; 0.170336 0.074958; 0.170479 0.024958; 0.290479 0.025303];
FS(23).type = 2;
plot (FS(23).v(:,1), FS(23).v(:,2), 'k');

FS(25).a = 0.000000;
FS(25).p = [0.200000;-0.050000];
FS(25).d = [0.290000;-0.025000;-0.170000;0.075000];
FS(25).D = [1.000000 0.000000;-0.000000 1.000000;-1.000000 -0.000000;0.000000 -1.000000];
FS(25).v = [0.290000 -0.075000; 0.290000 -0.025000; 0.170000 -0.025000; 0.170000 -0.075000; 0.290000 -0.075000];
FS(25).type = 2;
plot (FS(25).v(:,1), FS(25).v(:,2), 'k');

for i=1:length(FS)
    if FS(i).type == 2;
        plot (FS(i).p(1),FS(i).p(2),'gs','MarkerFaceColor','g','MarkerSize',4)
    end
end

CoM = [
0.020701 0.001055 0.251516    0.020701 0.001027 0.251513
0.020701 0.001055 0.251516    0.020712 0.001334 0.251598
0.020706 0.001055 0.251516    0.020699 0.001054 0.251514
0.020719 0.001055 0.251516    0.020613 0.001288 0.251539
0.020743 0.001056 0.251516    0.020694 0.001287 0.251513
0.020781 0.001058 0.251516    0.020716 0.001295 0.251529
0.020835 0.001060 0.251516    0.020708 0.001267 0.251510
0.020907 0.001063 0.251516    0.020682 0.001285 0.251522
0.020997 0.001068 0.251516    0.020680 0.001294 0.251523
0.021107 0.001074 0.251516    0.020679 0.001289 0.251518
0.021237 0.001082 0.251516    0.020680 0.001287 0.251519
0.021387 0.001092 0.251516    0.020696 0.001285 0.251517
0.021557 0.001104 0.251516    0.020680 0.001605 0.251593
0.021747 0.001119 0.251516    0.020681 0.001288 0.251521
0.021954 0.001135 0.251516    0.020696 0.001285 0.251517
0.022180 0.001154 0.251516    0.020679 0.001289 0.251518
0.022422 0.001173 0.251516    0.020929 0.001290 0.251505
0.022678 0.001193 0.251516    0.021013 0.001294 0.251488
0.022948 0.001213 0.251516    0.021012 0.001294 0.251487
0.023230 0.001231 0.251516    0.021025 0.001617 0.251554
0.023521 0.001246 0.251516    0.021202 0.001306 0.251518
0.023821 0.001256 0.251516    0.021440 0.001607 0.251620
0.024126 0.001260 0.251516    0.021401 0.001625 0.251622
0.024436 0.001255 0.251516    0.021922 0.001627 0.251635
0.024747 0.001238 0.251516    0.022151 0.001629 0.251663
0.025059 0.001209 0.251516    0.022654 0.001627 0.251666
0.025370 0.001163 0.251516    0.022987 0.001635 0.251631
0.025677 0.001098 0.251516    0.023740 0.001628 0.251665
0.025979 0.001012 0.251516    0.024356 0.001623 0.251586
0.026274 0.000900 0.251516    0.025112 0.001623 0.251620
0.026562 0.000760 0.251516    0.025629 0.001602 0.251596
0.026839 0.000589 0.251516    0.026286 0.001283 0.251485
0.027106 0.000384 0.251516    0.026846 0.001287 0.251476
0.027361 0.000140 0.251516    0.027687 0.001301 0.251449
0.027604 -0.000146 0.251516    0.028446 0.000977 0.251398
0.027832 -0.000477 0.251516    0.029202 0.000980 0.251414
0.028047 -0.000857 0.251516    0.029644 0.000640 0.251371
0.028248 -0.001290 0.251516    0.030032 0.000354 0.251350
0.028434 -0.001778 0.251516    0.030817 -0.000202 0.251280
0.028606 -0.002325 0.251516    0.030926 -0.000485 0.251307
0.028763 -0.002935 0.251516    0.031451 -0.001045 0.251209
0.028906 -0.003608 0.251516    0.031865 -0.001599 0.251195
0.029036 -0.004349 0.251516    0.032369 -0.002527 0.251056
0.029153 -0.005158 0.251516    0.032410 -0.003055 0.251118
0.029258 -0.006037 0.251516    0.032719 -0.003883 0.251036
0.029352 -0.006986 0.251516    0.033191 -0.004795 0.251032
0.029436 -0.008006 0.251516    0.033254 -0.005942 0.251034
0.029512 -0.009097 0.251516    0.033597 -0.007140 0.250963
0.029606 -0.010256 0.251516    0.033817 -0.008278 0.250972
0.029732 -0.011482 0.251516    0.034019 -0.009335 0.251058
0.029877 -0.012771 0.251516    0.033902 -0.010835 0.251010
0.029941 -0.014118 0.251516    0.033928 -0.012223 0.251074
0.029998 -0.015518 0.251516    0.034304 -0.013606 0.251039
0.030149 -0.016964 0.251516    0.033793 -0.015006 0.251116
0.030212 -0.018447 0.251516    0.033362 -0.016412 0.251227
0.030282 -0.019957 0.251516    0.033410 -0.018195 0.251114
0.030362 -0.021483 0.251516    0.032940 -0.019612 0.251217
0.030454 -0.023009 0.251516    0.032698 -0.021385 0.251180
0.030561 -0.024522 0.251516    0.032144 -0.023408 0.251066
0.030686 -0.026004 0.251516    0.031854 -0.025144 0.251005
0.030833 -0.027435 0.251516    0.031527 -0.026795 0.251110
0.031005 -0.028794 0.251516    0.031191 -0.027915 0.250893
0.031205 -0.030056 0.251516    0.030742 -0.029079 0.250396
0.031435 -0.031197 0.251516    0.030559 -0.030223 0.249939
0.031700 -0.032194 0.251516    0.030669 -0.031167 0.249822
0.032002 -0.033027 0.251516    0.030764 -0.031899 0.249755
0.032346 -0.033674 0.251516    0.031254 -0.032880 0.249831
0.032734 -0.034118 0.251516    0.031551 -0.032791 0.249757
0.033171 -0.034338 0.251516    0.032018 -0.032148 0.249820
0.033658 -0.034318 0.251516    0.032790 -0.031621 0.249985
0.034199 -0.034043 0.251516    0.033211 -0.030546 0.249886
0.034798 -0.033498 0.251516    0.033767 -0.030187 0.249917
0.035456 -0.032674 0.251516    0.034181 -0.029582 0.249984
0.036177 -0.031561 0.251516    0.034453 -0.029236 0.250031
0.036962 -0.030152 0.251516    0.034895 -0.028213 0.249950
0.037813 -0.028445 0.251516    0.034970 -0.027140 0.249770
0.038731 -0.026441 0.251516    0.035377 -0.025632 0.249666
0.039718 -0.024146 0.251516    0.035688 -0.024071 0.249696
0.040764 -0.021567 0.251516    0.036098 -0.021796 0.249713
0.041687 -0.018720 0.251516    0.035915 -0.019711 0.250009
0.042345 -0.015627 0.251516    0.036633 -0.017535 0.250479
0.043086 -0.012316 0.251516    0.037216 -0.015254 0.251123
0.043841 -0.008827 0.251516    0.038363 -0.012516 0.251610
0.044772 -0.005208 0.251516    0.039107 -0.009503 0.251704
0.045700 -0.001600 0.251516    0.040313 -0.006747 0.251817
0.046758 0.001769 0.251516    0.041853 -0.003921 0.251772
0.048002 0.004923 0.251516    0.043421 -0.001279 0.251606
0.049379 0.007771 0.251516    0.045528 0.001920 0.251565
0.050961 0.010473 0.251516    0.047824 0.005340 0.250661
0.052569 0.013104 0.251516    0.049754 0.008441 0.249936
0.054199 0.015572 0.251516    0.052492 0.011124 0.249612
0.055847 0.017788 0.251516    0.055598 0.013231 0.249188
0.057510 0.019646 0.251516    0.058652 0.014872 0.248890
0.059187 0.021105 0.251516    0.061997 0.016187 0.249051
0.060874 0.022180 0.251516    0.064871 0.017308 0.249216
0.062571 0.022925 0.251516    0.068013 0.018364 0.249259
0.064709 0.023415 0.251516    0.070967 0.018764 0.249223
0.067099 0.023530 0.251516    0.074303 0.019339 0.248992
0.069779 0.023432 0.251516    0.077429 0.019620 0.248783
0.072597 0.023042 0.251516    0.079182 0.019720 0.248710
0.075099 0.022303 0.251516    0.080872 0.019880 0.248762
0.077359 0.021220 0.251516    0.082874 0.019856 0.248777
0.079542 0.019795 0.251516    0.084895 0.019500 0.248812
0.081675 0.018039 0.251516    0.086266 0.017799 0.248575
0.083576 0.015960 0.251516    0.087105 0.015754 0.248530
0.085296 0.013574 0.251516    0.087363 0.013896 0.249276
0.087011 0.010900 0.251516    0.087849 0.012040 0.249945
0.088719 0.007968 0.251516    0.088349 0.010585 0.250471
0.090419 0.004821 0.251516    0.088879 0.007976 0.250971
0.092108 0.001510 0.251516    0.089679 0.005148 0.251285
0.093783 -0.001909 0.251516    0.090518 0.002522 0.251388
0.095439 -0.005243 0.251516    0.091323 -0.000250 0.251611
0.097040 -0.008388 0.251516    0.093014 -0.004075 0.251732
0.098643 -0.011616 0.251516    0.094640 -0.006205 0.251526
0.100228 -0.014282 0.251516    0.096597 -0.008253 0.250381
0.101787 -0.016491 0.251516    0.099622 -0.011297 0.249502
0.103317 -0.018659 0.251516    0.101657 -0.014150 0.249374
0.104818 -0.020731 0.251516    0.104863 -0.016437 0.249278
0.106291 -0.022553 0.251516    0.108061 -0.018374 0.249365
0.107736 -0.024088 0.251516    0.111092 -0.019446 0.249254
0.109154 -0.025155 0.251516    0.113795 -0.020855 0.249334
0.110740 -0.025991 0.251516    0.116795 -0.021831 0.249429
0.112728 -0.026530 0.251516    0.119441 -0.023017 0.249645
0.114894 -0.026774 0.251516    0.121475 -0.023764 0.249773
0.117004 -0.026671 0.251516    0.122878 -0.024206 0.249685
0.118887 -0.026219 0.251516    0.124737 -0.023947 0.249416
0.120752 -0.025416 0.251516    0.126121 -0.023662 0.249245
0.122463 -0.024262 0.251516    0.126592 -0.023253 0.249248
0.123796 -0.022761 0.251516    0.127950 -0.022573 0.249304
0.125134 -0.020919 0.251516    0.129264 -0.021035 0.249215
0.126464 -0.018745 0.251516    0.129657 -0.019007 0.248917
0.127757 -0.016251 0.251516    0.129575 -0.016662 0.249425
0.129055 -0.013457 0.251516    0.129354 -0.014494 0.250453
0.130360 -0.010394 0.251516    0.130222 -0.012396 0.251026
0.131673 -0.007105 0.251516    0.131170 -0.010608 0.251260
0.132994 -0.003645 0.251516    0.131474 -0.008489 0.251337
0.134320 -0.000326 0.251516    0.131473 -0.006348 0.251691
0.135651 0.002685 0.251516    0.131927 -0.003613 0.251888
0.136982 0.005586 0.251516    0.132638 0.000094 0.251437
0.138211 0.008585 0.251516    0.134098 0.002965 0.251473
0.139507 0.011281 0.251516    0.135020 0.004656 0.250427
0.140688 0.013373 0.251516    0.136343 0.007550 0.249765
0.141909 0.015392 0.251516    0.138254 0.010471 0.249394
0.143229 0.017365 0.251516    0.140447 0.012754 0.249077
0.144544 0.019110 0.251516    0.143185 0.015083 0.249007
0.145857 0.020706 0.251516    0.145758 0.016602 0.249235
0.147167 0.021951 0.251516    0.148015 0.018156 0.249475
0.148477 0.022899 0.251516    0.151579 0.019316 0.249440
0.149787 0.023518 0.251516    0.154404 0.019805 0.249232
0.151285 0.023808 0.251516    0.157063 0.020659 0.249246
0.153137 0.023769 0.251516    0.160095 0.021029 0.249161
0.155350 0.023401 0.251516    0.161285 0.021189 0.249219
0.157265 0.022705 0.251516    0.162594 0.021290 0.249145
0.159009 0.021683 0.251516    0.163977 0.021653 0.249218
0.160658 0.020337 0.251516    0.165160 0.021590 0.249338
0.162180 0.018667 0.251516    0.166757 0.020564 0.249197
0.163740 0.016678 0.251516    0.168442 0.018739 0.249044
0.165354 0.014375 0.251516    0.168425 0.016704 0.249387
0.166774 0.011773 0.251516    0.168929 0.014409 0.249938
0.168211 0.008898 0.251516    0.169243 0.012480 0.250431
0.169665 0.005790 0.251516    0.169285 0.009943 0.250851
0.171133 0.002550 0.251516    0.169271 0.007079 0.251264
0.172612 -0.000699 0.251516    0.169373 0.004318 0.251552
0.174098 -0.003858 0.251516    0.169478 0.000986 0.251747
0.175403 -0.007054 0.251516    0.170182 -0.002359 0.251964
0.176528 -0.010170 0.251516    0.171508 -0.005088 0.251735
0.177713 -0.012932 0.251516    0.172913 -0.007299 0.250564
0.178961 -0.015251 0.251516    0.174935 -0.010315 0.249683
0.180436 -0.017487 0.251516    0.176338 -0.013450 0.249526
0.181884 -0.019688 0.251516    0.178568 -0.016108 0.249432
0.183354 -0.021587 0.251516    0.180727 -0.018349 0.249629
0.184818 -0.023164 0.251516    0.182755 -0.020161 0.249798
0.186274 -0.024412 0.251516    0.185229 -0.021823 0.249809
0.187723 -0.025324 0.251516    0.188259 -0.022946 0.249715
0.189167 -0.025894 0.251516    0.190689 -0.023710 0.249753
0.190605 -0.026119 0.251516    0.192936 -0.024394 0.249881
0.192040 -0.025993 0.251516    0.194929 -0.024778 0.249965
0.193472 -0.025514 0.251516    0.196351 -0.025207 0.250022
0.194903 -0.024682 0.251516    0.197060 -0.025234 0.249968
0.196334 -0.023497 0.251516    0.197831 -0.025066 0.249979
0.197766 -0.021961 0.251516    0.198556 -0.023998 0.249924
0.199200 -0.020083 0.251516    0.198717 -0.022720 0.249835
0.200637 -0.017871 0.251516    0.198653 -0.021292 0.249759
0.202077 -0.015343 0.251516    0.198826 -0.019497 0.250048
0.203519 -0.012564 0.251516    0.198985 -0.017210 0.250831
0.204802 -0.009662 0.251516    0.198666 -0.014596 0.251524
0.205604 -0.006615 0.251516    0.199392 -0.011720 0.251429
0.206378 -0.003436 0.251516    0.201041 -0.008741 0.251738
0.207406 -0.000188 0.251516    0.202082 -0.005497 0.251995
0.208424 0.003127 0.251516    0.202856 -0.002457 0.252140
0.209349 0.006353 0.251516    0.203954 0.000888 0.251160
0.210302 0.009497 0.251516    0.205371 0.004280 0.251081
0.211365 0.012489 0.251516    0.206687 0.007771 0.250421
0.212472 0.015371 0.251516    0.207842 0.010787 0.249949
0.213557 0.018026 0.251516    0.209684 0.013764 0.249555
0.214792 0.020505 0.251516    0.211497 0.016088 0.249394
0.215984 0.022663 0.251516    0.213836 0.018005 0.249464
0.217131 0.024474 0.251516    0.215197 0.019367 0.249491
0.218229 0.025878 0.251516    0.217198 0.020394 0.249371
0.219279 0.026899 0.251516    0.219048 0.021651 0.249458
0.220277 0.027726 0.251516    0.221128 0.022448 0.249475
0.221222 0.028284 0.251516    0.223479 0.023108 0.249448
0.222114 0.028618 0.251516    0.225075 0.024029 0.249501
0.222951 0.028882 0.251516    0.226818 0.024866 0.249480
0.223735 0.029078 0.251516    0.227939 0.025279 0.249365
0.224526 0.029048 0.251516    0.229346 0.025627 0.249282
0.225448 0.028796 0.251516    0.229957 0.025589 0.249332
0.226223 0.028331 0.251516    0.230793 0.025297 0.249237
0.226964 0.027664 0.251516    0.231108 0.024547 0.249262
0.227526 0.026808 0.251516    0.230847 0.024373 0.249897
0.227995 0.025777 0.251516    0.230381 0.023666 0.250308
0.228416 0.024588 0.251516    0.230589 0.022380 0.250589
0.228789 0.023263 0.251516    0.230463 0.021977 0.250830
0.229118 0.021823 0.251516    0.229985 0.021377 0.250983
0.229403 0.020290 0.251516    0.229891 0.021077 0.251017
0.229647 0.018682 0.251516    0.228805 0.021446 0.251223
0.229853 0.017021 0.251516    0.228342 0.021032 0.251360
0.230022 0.015326 0.251516    0.227726 0.020595 0.251552
0.230157 0.013989 0.251516    0.227511 0.019285 0.251616
0.230261 0.012658 0.251516    0.227006 0.017565 0.251656
0.230336 0.011221 0.251516    0.226802 0.016435 0.251668
0.230385 0.009901 0.251516    0.227188 0.015232 0.251756
0.230410 0.008653 0.251516    0.227544 0.013541 0.251699
0.230413 0.007320 0.251516    0.228307 0.012084 0.251684
0.230397 0.006007 0.251516    0.229111 0.010417 0.251657
0.230365 0.004653 0.251516    0.230152 0.008106 0.251519
0.230318 0.003248 0.251516    0.230841 0.005895 0.251364
0.230259 0.001922 0.251516    0.231627 0.002665 0.251095
0.230190 0.000680 0.251516    0.232064 0.000520 0.251251
0.230113 -0.000475 0.251516    0.232427 -0.000678 0.251519
0.230030 -0.001540 0.251516    0.232626 -0.001701 0.251783
0.229942 -0.002512 0.251516    0.233190 -0.002427 0.251953
0.229852 -0.003391 0.251516    0.233219 -0.003334 0.251959
0.229760 -0.004175 0.251516    0.232806 -0.004160 0.252033
0.229668 -0.004867 0.251516    0.232821 -0.005002 0.251951];

CoM_expected = CoM(:, 1:3);
CoM_sensor = CoM(:, 4:6);

plot(CoM_expected(:,1), CoM_expected(:,2), 'b');
plot(CoM_sensor(:,1), CoM_sensor(:,2), 'r');
xlabel('x (meter)')
ylabel('y (meter)')
hold off
axis equal
print -depsc2 -FTimes:16 -tight ip_com_xy.eps

%%%%

cla; clf;
hold on
plot(CoM_expected(:,1), CoM_expected(:,3), 'b');
plot(CoM_sensor(:,1), CoM_sensor(:,3), 'r');
xlabel('x (meter)')
ylabel('z (meter)')
axis tight
hold off
pbaspect ([2 1 1])
print -depsc2 -FTimes:16 -tight ip_com_xz.eps

%%%%

cla; clf;
hold on
plot(CoM_expected(:,2), CoM_expected(:,3), 'b');
plot(CoM_sensor(:,2), CoM_sensor(:,3), 'r');
xlabel('y (meter)')
ylabel('z (meter)')
set (gca(), 'xdir', 'reverse')
axis tight
hold off
pbaspect ([2 1 1])
print -depsc2 -FTimes:16 -tight ip_com_yz.eps

%%%%

cla; clf;
hold on
plot(CoM (:,1) - CoM(:,4), 'b')
plot(CoM (:,2) - CoM(:,5), 'r')
plot(CoM (:,3) - CoM(:,6), 'k')
xlabel('Number of sampling interval')
ylabel('Error (meter)')
%legend ('along X axis', 'along Y axis', 'along Z axis');
hold off;
pbaspect ([2 1 1])
print -depsc2 -FTimes:16 -tight ip_com_error.eps
