cla;
clear FS;

hold on

FS(1).a = 0.000000;
FS(1).p = [0.000000;0.050000];
FS(1).d = [0.090000;0.075000;0.030000;-0.025000];
FS(1).D = [1.000000 0.000000;-0.000000 1.000000;-1.000000 -0.000000;0.000000 -1.000000];
FS(1).v = [0.090000 0.025000; 0.090000 0.075000; -0.030000 0.075000; -0.030000 0.025000; 0.090000 0.025000];
FS(1).type = 2;
plot (FS(1).v(:,1), FS(1).v(:,2), 'r');

FS(3).a = -0.006575;
FS(3).p = [0.000970;-0.049633];
FS(3).d = [0.091296;-0.024626;0.028704;0.074626];
FS(3).D = [0.999978 -0.006575;0.006575 0.999978;-0.999978 0.006575;-0.006575 -0.999978];
FS(3).v = [0.090804 -0.075224; 0.091132 -0.025225; -0.028865 -0.024436; -0.029194 -0.074435; 0.090804 -0.075224];
FS(3).type = 2;
plot (FS(3).v(:,1), FS(3).v(:,2), 'r');

FS(7).a = -0.007777;
FS(7).p = [0.042111;0.051991];
FS(7).d = [0.131705;0.077317;-0.011705;-0.027317];
FS(7).D = [0.999970 -0.007777;0.007777 0.999970;-0.999970 0.007777;-0.007777 -0.999970];
FS(7).v = [0.131913 0.026292; 0.132302 0.076291; 0.012306 0.077224; 0.011917 0.027225; 0.131913 0.026292];
FS(7).type = 2;
plot (FS(7).v(:,1), FS(7).v(:,2), 'k');

FS(11).a = -0.001870;
FS(11).p = [0.083318;-0.052291];
FS(11).d = [0.173416;-0.027135;-0.053416;0.077135];
FS(11).D = [0.999998 -0.001870;0.001870 0.999998;-0.999998 0.001870;-0.001870 -0.999998];
FS(11).v = [0.173271 -0.077459; 0.173365 -0.027459; 0.053365 -0.027235; 0.053271 -0.077235; 0.173271 -0.077459];
FS(11).type = 2;
plot (FS(11).v(:,1), FS(11).v(:,2), 'k');

FS(15).a = -0.008528;
FS(15).p = [0.122591;0.050442];
FS(15).d = [0.212156;0.076486;-0.092156;-0.026486];
FS(15).D = [0.999964 -0.008528;0.008528 0.999964;-0.999964 0.008528;-0.008528 -0.999964];
FS(15).v = [0.212374 0.024676; 0.212801 0.074674; 0.092805 0.075697; 0.092379 0.025699; 0.212374 0.024676];
FS(15).type = 2;
plot (FS(15).v(:,1), FS(15).v(:,2), 'r');

FS(19).a = -0.002185;
FS(19).p = [0.162943;-0.053136];
FS(19).d = [0.253058;-0.027779;-0.133058;0.077779];
FS(19).D = [0.999998 -0.002185;0.002185 0.999998;-0.999998 0.002185;-0.002185 -0.999998];
FS(19).v = [0.252888 -0.078332; 0.252997 -0.028332; 0.132997 -0.028070; 0.132888 -0.078070; 0.252888 -0.078332];
FS(19).type = 2;
plot (FS(19).v(:,1), FS(19).v(:,2), 'r');

FS(23).a = -0.003271;
FS(23).p = [0.201921;0.048933];
FS(23).d = [0.291760;0.074593;-0.171760;-0.024593];
FS(23).D = [0.999995 -0.003271;0.003271 0.999995;-0.999995 0.003271;-0.003271 -0.999995];
FS(23).v = [0.291839 0.023639; 0.292002 0.073638; 0.172003 0.074031; 0.171839 0.024031; 0.291839 0.023639];
FS(23).type = 2;
plot (FS(23).v(:,1), FS(23).v(:,2), 'k');

FS(25).a = 0.000000;
FS(25).p = [0.200000;-0.050000];
FS(25).d = [0.290000;-0.025000;-0.170000;0.075000];
FS(25).D = [1.000000 0.000000;-0.000000 1.000000;-1.000000 -0.000000;0.000000 -1.000000];
FS(25).v = [0.290000 -0.075000; 0.290000 -0.025000; 0.170000 -0.025000; 0.170000 -0.075000; 0.290000 -0.075000];
FS(25).type = 2;
plot (FS(25).v(:,1), FS(25).v(:,2), 'k');

for i=1:length(FS)
    if FS(i).type == 2;
        plot (FS(i).p(1),FS(i).p(2),'gs','MarkerFaceColor','g','MarkerSize',4)
    end
end

CoM = [
0.019386 0.000220 0.251818    0.019276 0.000186 0.251838
0.019386 0.000220 0.251818    0.019264 0.000306 0.251907
0.019391 0.000220 0.251818    0.019349 0.000224 0.251810
0.019402 0.000222 0.251818    0.019264 -0.000133 0.251753
0.019424 0.000224 0.251818    0.019355 0.000306 0.251887
0.019458 0.000228 0.251818    0.019275 0.000222 0.251836
0.019507 0.000233 0.251818    0.019267 0.000223 0.251834
0.019573 0.000241 0.251818    0.019353 0.000305 0.251884
0.019656 0.000251 0.251818    0.019275 0.000223 0.251836
0.019758 0.000263 0.251818    0.019358 0.000231 0.251817
0.019879 0.000278 0.251818    0.019274 0.000185 0.251835
0.020020 0.000295 0.251818    0.019281 0.000306 0.251910
0.020181 0.000315 0.251818    0.019271 0.000313 0.251910
0.020362 0.000337 0.251818    0.019276 -0.000096 0.251761
0.020561 0.000361 0.251818    0.019267 -0.000096 0.251757
0.020778 0.000387 0.251818    0.019282 0.000222 0.251829
0.021013 0.000413 0.251818    0.019370 0.000221 0.251806
0.021264 0.000440 0.251818    0.019571 0.000306 0.251926
0.021529 0.000466 0.251818    0.019690 0.000223 0.251906
0.021808 0.000490 0.251818    0.019688 0.000230 0.251906
0.022099 0.000510 0.251818    0.019769 0.000315 0.251958
0.022400 0.000524 0.251818    0.019978 0.000232 0.251919
0.022710 0.000532 0.251818    0.020488 0.000306 0.252000
0.023026 0.000530 0.251818    0.020415 0.000223 0.251942
0.023348 0.000517 0.251818    0.021022 0.000295 0.252028
0.023672 0.000489 0.251818    0.021371 0.000306 0.251965
0.023999 0.000445 0.251818    0.021875 0.000221 0.251892
0.024325 0.000382 0.251818    0.022439 0.000185 0.251900
0.024650 0.000296 0.251818    0.022930 0.000306 0.251966
0.024971 0.000186 0.251818    0.023481 0.000306 0.251962
0.025288 0.000047 0.251818    0.023830 0.000304 0.251935
0.025598 -0.000122 0.251818    0.024867 0.000229 0.251851
0.025901 -0.000325 0.251818    0.025439 -0.000097 0.251765
0.026196 -0.000565 0.251818    0.026276 -0.000090 0.251765
0.026481 -0.000846 0.251818    0.027030 -0.000334 0.251779
0.026756 -0.001169 0.251818    0.027914 -0.000318 0.251760
0.027021 -0.001539 0.251818    0.028331 -0.000874 0.251725
0.027273 -0.001958 0.251818    0.029091 -0.001186 0.251665
0.027514 -0.002428 0.251818    0.029358 -0.001434 0.251695
0.027744 -0.002952 0.251818    0.030071 -0.002038 0.251536
0.027961 -0.003533 0.251818    0.030731 -0.002550 0.251540
0.028166 -0.004171 0.251818    0.031158 -0.003167 0.251432
0.028360 -0.004869 0.251818    0.031886 -0.003680 0.251484
0.028543 -0.005628 0.251818    0.031929 -0.004559 0.251448
0.028715 -0.006447 0.251818    0.032467 -0.005060 0.251475
0.028878 -0.007326 0.251818    0.032684 -0.006225 0.251371
0.029032 -0.008266 0.251818    0.032917 -0.007071 0.251350
0.029179 -0.009265 0.251818    0.033197 -0.007923 0.251371
0.029325 -0.010320 0.251818    0.032990 -0.009120 0.251361
0.029462 -0.011428 0.251818    0.032927 -0.010160 0.251452
0.029595 -0.012587 0.251818    0.032865 -0.011329 0.251423
0.029728 -0.013791 0.251818    0.032796 -0.012508 0.251435
0.029861 -0.015035 0.251818    0.032332 -0.013586 0.251551
0.029998 -0.016313 0.251818    0.032214 -0.015027 0.251545
0.030140 -0.017616 0.251818    0.031557 -0.016475 0.251551
0.030290 -0.018937 0.251818    0.031366 -0.017902 0.251635
0.030450 -0.020264 0.251818    0.031473 -0.019603 0.251590
0.030624 -0.021587 0.251818    0.030886 -0.021420 0.251416
0.030814 -0.022893 0.251818    0.031000 -0.023157 0.251333
0.031023 -0.024168 0.251818    0.030646 -0.024913 0.251316
0.031254 -0.025396 0.251818    0.030228 -0.026585 0.251791
0.031510 -0.026559 0.251818    0.030208 -0.027262 0.251535
0.031794 -0.027640 0.251818    0.030097 -0.028342 0.251207
0.032108 -0.028619 0.251818    0.030541 -0.029577 0.250846
0.032456 -0.029475 0.251818    0.030729 -0.030309 0.250720
0.032841 -0.030190 0.251818    0.031603 -0.030738 0.250838
0.033265 -0.030743 0.251818    0.032469 -0.030717 0.250622
0.033732 -0.031116 0.251818    0.033308 -0.030067 0.250422
0.034243 -0.031291 0.251818    0.034163 -0.029433 0.250383
0.034802 -0.031248 0.251818    0.034740 -0.028843 0.250415
0.035411 -0.030974 0.251818    0.035373 -0.028713 0.250459
0.036072 -0.030452 0.251818    0.036101 -0.028511 0.250537
0.036787 -0.029673 0.251818    0.036983 -0.027860 0.250482
0.037558 -0.028626 0.251818    0.037219 -0.027431 0.250459
0.038387 -0.027308 0.251818    0.037638 -0.026326 0.250401
0.039273 -0.025717 0.251818    0.038128 -0.025311 0.250360
0.040219 -0.023857 0.251818    0.038983 -0.023510 0.250142
0.041223 -0.021737 0.251818    0.038832 -0.021752 0.250105
0.042287 -0.019370 0.251818    0.039386 -0.019834 0.250229
0.043409 -0.016776 0.251818    0.039416 -0.017542 0.250641
0.044588 -0.013980 0.251818    0.039461 -0.015444 0.251580
0.045484 -0.011012 0.251818    0.040242 -0.013931 0.252708
0.046399 -0.007907 0.251818    0.041373 -0.011304 0.252741
0.047428 -0.004705 0.251818    0.042056 -0.008507 0.252496
0.048398 -0.001449 0.251818    0.043373 -0.006361 0.252494
0.049513 0.001541 0.251818    0.045100 -0.005282 0.252675
0.050848 0.003909 0.251818    0.046931 -0.001911 0.251783
0.052340 0.006414 0.251818    0.049193 0.000639 0.251905
0.053862 0.008640 0.251818    0.051280 0.002101 0.251043
0.055410 0.010327 0.251818    0.052987 0.003523 0.249907
0.056982 0.011632 0.251818    0.056178 0.005500 0.249379
0.058575 0.012845 0.251818    0.059668 0.007369 0.249144
0.060188 0.013973 0.251818    0.062947 0.009267 0.249174
0.061819 0.015058 0.251818    0.065760 0.011060 0.249452
0.063465 0.016089 0.251818    0.068562 0.012392 0.249597
0.065456 0.016862 0.251818    0.071778 0.013777 0.249700
0.067827 0.017383 0.251818    0.074596 0.014339 0.249709
0.070344 0.017655 0.251818    0.077468 0.015081 0.249644
0.072978 0.017681 0.251818    0.079626 0.015369 0.249600
0.075478 0.017461 0.251818    0.081303 0.015475 0.249497
0.077738 0.016995 0.251818    0.083067 0.015489 0.249337
0.079853 0.016279 0.251818    0.084881 0.015360 0.249283
0.081881 0.015310 0.251818    0.086485 0.014359 0.249070
0.083783 0.014084 0.251818    0.087490 0.012957 0.248998
0.085503 0.012595 0.251818    0.087792 0.011162 0.249329
0.087221 0.010839 0.251818    0.088686 0.009476 0.249880
0.088933 0.008809 0.251818    0.089379 0.007449 0.250197
0.090639 0.006509 0.251818    0.089975 0.005926 0.251008
0.092336 0.003974 0.251818    0.091043 0.004457 0.251597
0.094021 0.001253 0.251818    0.091679 0.002224 0.251520
0.095692 -0.001604 0.251818    0.091983 0.000604 0.251924
0.097344 -0.004541 0.251818    0.092697 -0.000869 0.252198
0.098781 -0.007494 0.251818    0.093553 -0.003779 0.252478
0.100022 -0.010340 0.251818    0.095330 -0.006606 0.252603
0.101400 -0.012949 0.251818    0.097080 -0.007116 0.251489
0.102867 -0.014741 0.251818    0.099596 -0.008406 0.250268
0.104405 -0.016114 0.251818    0.101469 -0.010141 0.249930
0.105919 -0.017325 0.251818    0.105201 -0.012129 0.249685
0.107411 -0.018499 0.251818    0.108085 -0.014379 0.249817
0.108882 -0.019724 0.251818    0.110710 -0.015811 0.249904
0.110332 -0.020715 0.251818    0.112891 -0.016992 0.249999
0.111764 -0.021433 0.251818    0.115432 -0.018209 0.249933
0.113180 -0.021878 0.251818    0.117592 -0.019030 0.249996
0.114705 -0.022047 0.251818    0.118972 -0.020052 0.250194
0.116175 -0.021941 0.251818    0.120187 -0.020331 0.250150
0.117560 -0.021556 0.251818    0.121301 -0.020542 0.250267
0.118935 -0.020893 0.251818    0.122169 -0.020573 0.250378
0.120305 -0.019951 0.251818    0.122581 -0.020358 0.250395
0.121674 -0.018730 0.251818    0.123015 -0.019557 0.250372
0.123044 -0.017232 0.251818    0.123791 -0.018301 0.250279
0.124416 -0.015459 0.251818    0.123774 -0.016775 0.250179
0.125793 -0.013418 0.251818    0.123876 -0.014592 0.250323
0.127176 -0.011116 0.251818    0.123503 -0.012664 0.250759
0.128566 -0.008565 0.251818    0.123240 -0.010354 0.251757
0.129566 -0.005803 0.251818    0.124461 -0.007993 0.252284
0.130639 -0.002876 0.251818    0.125134 -0.005686 0.252303
0.131597 0.000165 0.251818    0.125743 -0.003471 0.252616
0.132455 0.003267 0.251818    0.126565 -0.001845 0.252739
0.133306 0.006033 0.251818    0.127393 -0.000036 0.251664
0.134153 0.008389 0.251818    0.128756 0.002522 0.251602
0.135157 0.010565 0.251818    0.130746 0.004520 0.250890
0.136460 0.012418 0.251818    0.132062 0.006889 0.250276
0.137771 0.014153 0.251818    0.134574 0.008580 0.249777
0.139207 0.015598 0.251818    0.137306 0.010685 0.249393
0.140648 0.016962 0.251818    0.140300 0.012414 0.249527
0.142097 0.018155 0.251818    0.142933 0.013674 0.249609
0.143555 0.019084 0.251818    0.145333 0.015090 0.249647
0.145023 0.019874 0.251818    0.148418 0.016143 0.249727
0.146502 0.020377 0.251818    0.151021 0.016952 0.249817
0.148150 0.020595 0.251818    0.153197 0.017304 0.249750
0.149971 0.020526 0.251818    0.155492 0.017625 0.249698
0.151949 0.020170 0.251818    0.157173 0.017940 0.249656
0.153854 0.019528 0.251818    0.158527 0.017767 0.249609
0.155610 0.018604 0.251818    0.159966 0.017556 0.249530
0.157289 0.017398 0.251818    0.161090 0.016752 0.249481
0.158878 0.015918 0.251818    0.161797 0.015279 0.249462
0.160483 0.014167 0.251818    0.162494 0.013458 0.249659
0.162106 0.012157 0.251818    0.162850 0.011398 0.249985
0.163744 0.009897 0.251818    0.162702 0.009382 0.250429
0.165398 0.007405 0.251818    0.163021 0.007932 0.251451
0.167064 0.004716 0.251818    0.163623 0.006146 0.251916
0.168741 0.001876 0.251818    0.163566 0.004205 0.251931
0.170072 -0.001068 0.251818    0.163802 0.002545 0.252345
0.171079 -0.004064 0.251818    0.163924 0.000649 0.252591
0.171821 -0.006839 0.251818    0.164846 -0.002706 0.251971
0.172617 -0.009662 0.251818    0.166184 -0.005291 0.252111
0.173573 -0.012155 0.251818    0.167759 -0.006139 0.251033
0.174712 -0.013870 0.251818    0.169479 -0.007259 0.249587
0.176023 -0.015125 0.251818    0.171662 -0.009203 0.249361
0.177591 -0.016309 0.251818    0.174279 -0.011252 0.249392
0.179264 -0.017480 0.251818    0.176691 -0.012944 0.249506
0.180933 -0.018539 0.251818    0.179582 -0.014668 0.249753
0.182598 -0.019492 0.251818    0.182188 -0.016146 0.249868
0.184259 -0.020183 0.251818    0.184545 -0.017259 0.249938
0.185917 -0.020611 0.251818    0.186828 -0.018465 0.250196
0.187572 -0.020777 0.251818    0.188812 -0.019050 0.250370
0.189224 -0.020681 0.251818    0.190769 -0.019352 0.250389
0.190872 -0.020319 0.251818    0.191749 -0.019412 0.250381
0.192517 -0.019690 0.251818    0.192402 -0.019477 0.250482
0.194158 -0.018791 0.251818    0.193525 -0.019174 0.250444
0.195795 -0.017619 0.251818    0.194218 -0.018356 0.250337
0.197427 -0.016170 0.251818    0.194284 -0.017221 0.250162
0.199053 -0.014441 0.251818    0.195064 -0.015790 0.250141
0.200671 -0.012432 0.251818    0.195124 -0.014024 0.250242
0.201816 -0.010140 0.251818    0.195743 -0.011865 0.250713
0.202792 -0.007573 0.251818    0.196105 -0.009469 0.251488
0.203569 -0.004759 0.251818    0.197039 -0.006747 0.251720
0.204375 -0.001743 0.251818    0.198382 -0.004083 0.251790
0.205319 0.001431 0.251818    0.199579 -0.001868 0.252124
0.206313 0.004712 0.251818    0.200532 0.000360 0.252185
0.207264 0.007931 0.251818    0.201862 0.002199 0.251737
0.208296 0.010658 0.251818    0.203832 0.004866 0.251614
0.209573 0.013180 0.251818    0.205498 0.007785 0.251011
0.210927 0.015608 0.251818    0.207230 0.010287 0.250400
0.212262 0.017836 0.251818    0.209147 0.012956 0.250067
0.213553 0.019970 0.251818    0.211827 0.015782 0.249772
0.214798 0.022081 0.251818    0.214146 0.017797 0.249665
0.215996 0.023930 0.251818    0.216002 0.019150 0.249882
0.217144 0.025395 0.251818    0.218065 0.020631 0.249951
0.218242 0.026629 0.251818    0.220134 0.021827 0.249894
0.219288 0.027616 0.251818    0.222210 0.022895 0.249913
0.220282 0.028395 0.251818    0.224618 0.023761 0.249894
0.221324 0.028970 0.251818    0.226412 0.024550 0.249832
0.222538 0.029386 0.251818    0.227995 0.025303 0.249809
0.223810 0.029683 0.251818    0.229144 0.026006 0.249760
0.224991 0.029794 0.251818    0.229964 0.026570 0.249799
0.226010 0.029702 0.251818    0.230826 0.026486 0.249720
0.226928 0.029416 0.251818    0.231955 0.026433 0.249778
0.227857 0.028946 0.251818    0.231962 0.026199 0.250059
0.228456 0.028304 0.251818    0.231624 0.025797 0.250532
0.228972 0.027504 0.251818    0.231964 0.025420 0.251007
0.229437 0.026559 0.251818    0.232026 0.024627 0.251371
0.229853 0.025484 0.251818    0.232081 0.024591 0.251574
0.230220 0.024296 0.251818    0.231768 0.024863 0.251505
0.230541 0.023009 0.251818    0.230914 0.025684 0.251556
0.230817 0.021639 0.251818    0.230159 0.025772 0.251682
0.231050 0.020241 0.251818    0.229401 0.025315 0.251816
0.231241 0.019072 0.251818    0.228598 0.024335 0.251965
0.231394 0.017919 0.251818    0.228170 0.023701 0.252150
0.231511 0.016895 0.251818    0.228166 0.022586 0.252191
0.231593 0.015830 0.251818    0.228094 0.021916 0.252273
0.231643 0.014880 0.251818    0.228387 0.020804 0.252233
0.231664 0.013889 0.251818    0.228590 0.019355 0.252225
0.231658 0.012777 0.251818    0.229235 0.017995 0.252259
0.231627 0.011617 0.251818    0.230290 0.016194 0.252113
0.231575 0.010299 0.251818    0.231280 0.014475 0.252017
0.231502 0.008903 0.251818    0.232465 0.012793 0.251963
0.231412 0.007501 0.251818    0.233424 0.011177 0.251963
0.231307 0.006154 0.251818    0.234421 0.008540 0.251711
0.231189 0.004865 0.251818    0.234773 0.005412 0.251644
0.231060 0.003641 0.251818    0.235017 0.003844 0.252078
0.230923 0.002484 0.251818    0.235651 0.003061 0.252287
0.230997 0.001397 0.251818    0.235385 0.002173 0.252409
0.230965 0.000384 0.251818    0.234972 0.001043 0.252472
0.230815 -0.000555 0.251818    0.234396 -0.000197 0.252400];

CoM_expected = CoM(:, 1:3);
CoM_sensor = CoM(:, 4:6);

plot(CoM_expected(:,1), CoM_expected(:,2), 'b');
plot(CoM_sensor(:,1), CoM_sensor(:,2), 'r');
xlabel('x (meter)')
ylabel('y (meter)')
hold off
axis equal
print -depsc2 -FTimes:16 -tight as_com_xy.eps

%%%%

cla; clf;
hold on
plot(CoM_expected(:,1), CoM_expected(:,3), 'b');
plot(CoM_sensor(:,1), CoM_sensor(:,3), 'r');
xlabel('x (meter)')
ylabel('z (meter)')
axis tight
hold off
pbaspect ([2 1 1])
print -depsc2 -FTimes:16 -tight as_com_xz.eps

%%%%

cla; clf;
hold on
plot(CoM_expected(:,2), CoM_expected(:,3), 'b');
plot(CoM_sensor(:,2), CoM_sensor(:,3), 'r');
xlabel('y (meter)')
ylabel('z (meter)')
set (gca(), 'xdir', 'reverse')
axis tight
hold off
pbaspect ([2 1 1])
print -depsc2 -FTimes:16 -tight as_com_yz.eps

%%%%

cla; clf;
hold on
plot(CoM (:,1) - CoM(:,4), 'b')
plot(CoM (:,2) - CoM(:,5), 'r')
plot(CoM (:,3) - CoM(:,6), 'k')
xlabel('Number of sampling interval')
ylabel('Error (meter)')
%legend ('along X axis', 'along Y axis', 'along Z axis');
hold off;
pbaspect ([2 1 1])
print -depsc2 -FTimes:16 -tight as_com_error.eps
